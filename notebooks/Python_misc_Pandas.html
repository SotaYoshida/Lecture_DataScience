
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Pandasの使い方 (基礎) &#8212; プログラミング演習1・実践データサイエンス</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-F7NT8KLGKR"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-F7NT8KLGKR');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-F7NT8KLGKR');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Python_misc_Pandas';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Numpyについて" href="Python_misc_numpy.html" />
    <link rel="prev" title="LaTeXの記法" href="LaTeX_in_markdown.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="プログラミング演習1・実践データサイエンス - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="プログラミング演習1・実践データサイエンス - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    資料について
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">プログラムの実行方法</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Python_chapter0_HowToUse.html">Google Colaboratoryの使い方</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">練習帳</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Python_practice.html">練習帳</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの基本文法</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Python_chapter1_Introduction.html">1. Pythonの基本 その１:</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter2_ListLoop.html">2. Pythonの基本 その２:</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter3_Function.html">3. 自作関数</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ライブラリと可視化</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Python_chapter4_Matplotlib.html">4. ライブラリ/パッケージ/モジュールとデータの可視化(Matplotlib)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">データ分析の基礎</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Python_chapter5_Probability.html">5. 確率と疑似乱数</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter6_Regression.html">6. 相関・回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter7_Optimization.html">7. 最適化問題の基礎</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter8_handling_files.html">8. ファイル・文字列操作</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tips&amp;環境構築</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Python_misc_Error.html">よくあるエラー集</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_misc_python_environment.html">Pythonの環境構築</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_misc_python_env_forWin11.html">Pythonの環境構築 (Windows11版)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_misc_VScode.html">コードの編集環境とGitHub Copilot</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_venv_pip.html">Pythonのモジュール/ライブラリの管理と仮想環境の構築</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">おまけ</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="LaTeX_in_markdown.html">LaTeXの記法</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Pandasの使い方 (基礎)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_misc_numpy.html">Numpyについて</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter_ArtificialNeuralNetwork.html">機械学習: ニューラルネットワークによる回帰</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter_BayesianOptimization.html">ベイズ最適化による実験計画法</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter_Bayesian_linear_regression.html">ベイズ線形回帰</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_misc_StyleGAN3.html">StyleGAN3+CLIPによる写真生成</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_chapter_WebScraping.html">Webスクレイピング・ブラウザ操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_misc_ODE.html">常微分方程式の数値解法</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_misc_PCA.html">主成分分析</a></li>

<li class="toctree-l1"><a class="reference internal" href="Python_misc_SingularValueDecomposition.html">特異値分解と情報削減</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_misc_NewtonsMethod.html">ニュートン法によるN次元多項式の求根</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/SotaYoshida/Lecture_DataScience/blob/main/notebooks/Python_misc_Pandas.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SotaYoshida/Lecture_DataScience" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SotaYoshida/Lecture_DataScience/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Python_misc_Pandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/Python_misc_Pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pandasの使い方 (基礎)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">DataFrame型</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">DataFrameの要素を確認・指定する方法</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">特定の列を取得したい場合</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">列の追加</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">特定の行を取得したい場合</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">より複雑な行・列の抽出</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#webdataframe">Webページにある表をDataFrameとして取得する</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandascsv-excel">Pandasでcsv/Excelファイルを読み込む</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#csv">csvファイルの読み込み</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excel">Excelファイルの読み込み</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Excelファイルの読み込みに関する補足</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">データの整形</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframecsv-excel">DataFrameのcsv/Excelファイルへの書き出し</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a href="https://colab.research.google.com/github/SotaYoshida/Lecture_DataScience/blob/main/notebooks/Python_misc_Pandas.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="pandas">
<h1>Pandasの使い方 (基礎)<a class="headerlink" href="#pandas" title="Link to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">Pandas</span></code>は、データ分析のためのライブラリで<br />
統計量を計算・表示したり、それらをグラフとして可視化出来たり<br />
前処理などの地道だが重要な作業を比較的簡単に行うことができる。</p>
<p>まずはインポートしよう。<code class="docutils literal notranslate"><span class="pre">pd</span></code>という名前で使うのが慣例。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span> 
</pre></div>
</div>
</div>
</div>
<p>pandasでは主に<code class="docutils literal notranslate"><span class="pre">Series</span></code>と<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の２つのオブジェクトを扱う。<br />
<code class="docutils literal notranslate"><span class="pre">Series</span></code>は<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>の特殊な場合とみなせるので、以下では<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>のみ説明することにします。</p>
<section id="dataframe">
<h2>DataFrame型<a class="headerlink" href="#dataframe" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>はExcelシートのような二次元のデータを表現するのに利用され各種データ分析などで非常に役に立つ。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span>
</pre></div>
</div>
</div>
</div>
<p>以下の辞書型をDataFrameのオブジェクトに変換してみましょう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;名前&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Aさん&quot;</span><span class="p">,</span> <span class="s2">&quot;Bさん&quot;</span><span class="p">,</span> <span class="s2">&quot;Cさん&quot;</span><span class="p">,</span> <span class="s2">&quot;Dさん&quot;</span><span class="p">,</span> <span class="s2">&quot;Eさん&quot;</span><span class="p">],</span>
        <span class="s1">&#39;出身都道府県&#39;</span><span class="p">:[</span><span class="s1">&#39;Tokyo&#39;</span><span class="p">,</span> <span class="s1">&#39;Tochigi&#39;</span><span class="p">,</span> <span class="s1">&#39;Hokkaido&#39;</span><span class="p">,</span><span class="s1">&#39;Kyoto&#39;</span><span class="p">,</span><span class="s1">&#39;Tochigi&#39;</span><span class="p">],</span>
        <span class="s1">&#39;生年&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1998</span><span class="p">,</span> <span class="mi">1993</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1989</span><span class="p">,</span><span class="mi">2002</span><span class="p">],</span>
        <span class="s1">&#39;身長&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">172</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span><span class="mi">158</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dataの型&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dfの型&quot;</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dataの型 &lt;class &#39;dict&#39;&gt;
dfの型 &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>jupyter環境でDataFrameをコードセルの最終行に書くと、”いい感じ”に表示してくれる</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>名前</th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aさん</td>
      <td>Tokyo</td>
      <td>1998</td>
      <td>172</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bさん</td>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cさん</td>
      <td>Hokkaido</td>
      <td>2000</td>
      <td>162</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dさん</td>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eさん</td>
      <td>Tochigi</td>
      <td>2002</td>
      <td>158</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>printだとちょっと無機質な感じに。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    名前    出身都道府県    生年   身長
0  Aさん     Tokyo  1998  172
1  Bさん   Tochigi  1993  156
2  Cさん  Hokkaido  2000  162
3  Dさん     Kyoto  1989  180
4  Eさん   Tochigi  2002  158
</pre></div>
</div>
</div>
</div>
<p>単一のコードセルの途中でDataFrameを表示したい場合などは、<code class="docutils literal notranslate"><span class="pre">display</span></code>関数を使うと良い。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>名前</th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aさん</td>
      <td>Tokyo</td>
      <td>1998</td>
      <td>172</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bさん</td>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cさん</td>
      <td>Hokkaido</td>
      <td>2000</td>
      <td>162</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dさん</td>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eさん</td>
      <td>Tochigi</td>
      <td>2002</td>
      <td>158</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">info()</span></code>関数を作用させると、詳細な情報が得られる。<br />
列ごとにどんな種類のデータが格納されているのかや、
メモリ使用量など表示することができる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5 entries, 0 to 4
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   名前      5 non-null      object
 1   出身都道府県  5 non-null      object
 2   生年      5 non-null      int64 
 3   身長      5 non-null      int64 
dtypes: int64(2), object(2)
memory usage: 292.0+ bytes
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>DataFrameの要素を確認・指定する方法<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">index</span></code>: 行方向のデータ項目(おもに整数値(行番号),ID,名前など)<br />
<code class="docutils literal notranslate"><span class="pre">columns</span></code>: 列方向のデータの項目(おもにデータの種類)<br />
をそれぞれ表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=5, step=1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;名前&#39;, &#39;出身都道府県&#39;, &#39;生年&#39;, &#39;身長&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>行方向を、整数値(行数)ではなく名前にしたければ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;出身都道府県&#39;</span><span class="p">:[</span><span class="s1">&#39;Tokyo&#39;</span><span class="p">,</span> <span class="s1">&#39;Tochigi&#39;</span><span class="p">,</span> <span class="s1">&#39;Hokkaido&#39;</span><span class="p">,</span><span class="s1">&#39;Kyoto&#39;</span><span class="p">,</span><span class="s1">&#39;Tochigi&#39;</span><span class="p">],</span>
        <span class="s1">&#39;生年&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1998</span><span class="p">,</span> <span class="mi">1993</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1989</span><span class="p">,</span><span class="mi">2002</span><span class="p">],</span>
        <span class="s1">&#39;身長&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">172</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span><span class="mi">158</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;Aさん&quot;</span><span class="p">,</span> <span class="s2">&quot;Bさん&quot;</span><span class="p">,</span> <span class="s2">&quot;Cさん&quot;</span><span class="p">,</span> <span class="s2">&quot;Dさん&quot;</span><span class="p">,</span> <span class="s2">&quot;Eさん&quot;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aさん</th>
      <td>Tokyo</td>
      <td>1998</td>
      <td>172</td>
    </tr>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
    </tr>
    <tr>
      <th>Cさん</th>
      <td>Hokkaido</td>
      <td>2000</td>
      <td>162</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
    </tr>
    <tr>
      <th>Eさん</th>
      <td>Tochigi</td>
      <td>2002</td>
      <td>158</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>などとしてもよい。</p>
<section id="id2">
<h3>特定の列を取得したい場合<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;身長&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Aさん    172
Bさん    156
Cさん    162
Dさん    180
Eさん    158
Name: 身長, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>と列名を指定すればよい。<br />
以下の方法でも取得できるが、この授業では非推奨とする。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">身長</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Aさん    172
Bさん    156
Cさん    162
Dさん    180
Eさん    158
Name: 身長, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>値のリスト(正確にはnumpy.ndarray型)として取得したければ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;身長&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([172, 156, 162, 180, 158])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;出身都道府県&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Tokyo&#39;, &#39;Tochigi&#39;, &#39;Hokkaido&#39;, &#39;Kyoto&#39;, &#39;Tochigi&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>などとすればよい。</p>
<p>慣れ親しんだ形に変換したければ、リストに変換すればよい</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;出身都道府県&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Tokyo&#39;, &#39;Tochigi&#39;, &#39;Hokkaido&#39;, &#39;Kyoto&#39;, &#39;Tochigi&#39;]
</pre></div>
</div>
</div>
</div>
<p>ある列が特定のものに一致するもののみを抽出するのも簡単にできる</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;出身都道府県&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Tochigi&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
    </tr>
    <tr>
      <th>Eさん</th>
      <td>Tochigi</td>
      <td>2002</td>
      <td>158</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>これは</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;出身都道府県&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Tochigi&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Aさん    False
Bさん     True
Cさん    False
Dさん    False
Eさん     True
Name: 出身都道府県, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>が条件に合致するかどうかTrue/Falseの配列(正確には<code class="docutils literal notranslate"><span class="pre">Series</span></code>)になっていて、<br />
df[ [True/Falseの配列] ]とすると、Trueに対応する要素のみを返すフィルターのような役割になっている。</p>
</section>
<section id="id3">
<h3>列の追加<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#スカラー値の場合&quot;初期化&quot;のような振る舞いをする</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;血液型&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
      <th>血液型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aさん</th>
      <td>Tokyo</td>
      <td>1998</td>
      <td>172</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Cさん</th>
      <td>Hokkaido</td>
      <td>2000</td>
      <td>162</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Eさん</th>
      <td>Tochigi</td>
      <td>2002</td>
      <td>158</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;血液型&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;B&quot;</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
      <th>血液型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aさん</th>
      <td>Tokyo</td>
      <td>1998</td>
      <td>172</td>
      <td>B</td>
    </tr>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
      <td>B</td>
    </tr>
    <tr>
      <th>Cさん</th>
      <td>Hokkaido</td>
      <td>2000</td>
      <td>162</td>
      <td>B</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
      <td>B</td>
    </tr>
    <tr>
      <th>Eさん</th>
      <td>Tochigi</td>
      <td>2002</td>
      <td>158</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>リストや<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>を列として追加することができる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#リストで追加</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;血液型&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span><span class="s2">&quot;AB&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
      <th>血液型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aさん</th>
      <td>Tokyo</td>
      <td>1998</td>
      <td>172</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
      <td>O</td>
    </tr>
    <tr>
      <th>Cさん</th>
      <td>Hokkaido</td>
      <td>2000</td>
      <td>162</td>
      <td>AB</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
      <td>B</td>
    </tr>
    <tr>
      <th>Eさん</th>
      <td>Tochigi</td>
      <td>2002</td>
      <td>158</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id4">
<h3>特定の行を取得したい場合<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>たとえば、行番号がわかっているなら、<code class="docutils literal notranslate"><span class="pre">iloc</span></code>関数を使えば良い</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>出身都道府県    Kyoto
生年         1989
身長          180
血液型           B
Name: Dさん, dtype: object
</pre></div>
</div>
</div>
</div>
<p>値のみ取得したければ先程と同様<code class="docutils literal notranslate"><span class="pre">values</span></code>で<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>を取得できる</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Kyoto&#39;, 1989, 180, &#39;B&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>また、以下のような使い方もできるが</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
      <th>血液型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
      <td>O</td>
    </tr>
    <tr>
      <th>Cさん</th>
      <td>Hokkaido</td>
      <td>2000</td>
      <td>162</td>
      <td>AB</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">df[1]</span></code>といった使い方は出来ず、KeyErrorが発生する、</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File ~/.pyenv/versions/3.11.4/lib/python3.11/site-packages/pandas/core/indexes/base.py:3805,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3804</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3805</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3806</span> <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File index.pyx:167,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File index.pyx:196,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File pandas/_libs/hashtable_class_helper.pxi:7081,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="nn">File pandas/_libs/hashtable_class_helper.pxi:7089,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="ne">KeyError</span>: 1

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nn">File ~/.pyenv/versions/3.11.4/lib/python3.11/site-packages/pandas/core/frame.py:4102,</span> in <span class="ni">DataFrame.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">4100</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4101</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_multilevel</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">4102</span> <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4103</span> <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">indexer</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">4104</span>     <span class="n">indexer</span> <span class="o">=</span> <span class="p">[</span><span class="n">indexer</span><span class="p">]</span>

<span class="nn">File ~/.pyenv/versions/3.11.4/lib/python3.11/site-packages/pandas/core/indexes/base.py:3812,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3807</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">casted_key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3808</span>         <span class="nb">isinstance</span><span class="p">(</span><span class="n">casted_key</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3809</span>         <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3810</span>     <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3811</span>         <span class="k">raise</span> <span class="n">InvalidIndexError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3812</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
<span class="g g-Whitespace">   </span><span class="mi">3813</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3814</span>     <span class="c1"># If we have a listlike key, _check_indexing_error will raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3815</span>     <span class="c1">#  InvalidIndexError. Otherwise we fall through and re-raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3816</span>     <span class="c1">#  the TypeError.</span>
<span class="g g-Whitespace">   </span><span class="mi">3817</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_indexing_error</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: 1
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>より複雑な行・列の抽出<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>上にならって、2000年より前に生まれた人だけを抽出し</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;生年&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2000</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
      <th>血液型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aさん</th>
      <td>Tokyo</td>
      <td>1998</td>
      <td>172</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
      <td>O</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>さらにこのうち身長が170cm以上の人だけがほしければ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;生年&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;身長&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">170</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
      <th>血液型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aさん</th>
      <td>Tokyo</td>
      <td>1998</td>
      <td>172</td>
      <td>A</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>などとすればよい。<strong>複数条件の場合は、条件を()で囲む必要があることに注意</strong>しよう。</p>
<p>他にも<code class="docutils literal notranslate"><span class="pre">iloc</span></code>,<code class="docutils literal notranslate"><span class="pre">loc</span></code>などを用いれば、特定の行・列を抽出することができる</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">iloc</span></code>は番号の指定のみに対応</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code>は名前(列名・行明)のみ</p></li>
</ul>
<p><strong>欲しい要素の数値もしくは項目名のリスト</strong>を行・列のそれぞれについて指定してやればよい。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="c1">#0行目,0列目</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aさん</th>
      <td>Tokyo</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#スライスで指定することもできる</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1">#1-3行目かつ0-2列目 (スライスの終点は含まれないことに注意)</span>
<span class="c1">#スライスの場合は、 1:4が[1,2,3]と同じ働きをするので、括弧[]はいらない</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
      <th>身長</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
      <td>156</td>
    </tr>
    <tr>
      <th>Cさん</th>
      <td>Hokkaido</td>
      <td>2000</td>
      <td>162</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
      <td>180</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">loc</span></code>を使う場合は、indexの代わりに項目名で指定する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;Aさん&quot;</span><span class="p">,</span><span class="s2">&quot;Cさん&quot;</span><span class="p">],[</span><span class="s2">&quot;出身都道府県&quot;</span><span class="p">,</span><span class="s2">&quot;身長&quot;</span><span class="p">]]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>身長</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aさん</th>
      <td>Tokyo</td>
      <td>172</td>
    </tr>
    <tr>
      <th>Cさん</th>
      <td>Hokkaido</td>
      <td>162</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>スライス的に指定することもできる</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Bさん&quot;</span><span class="p">:</span><span class="s2">&quot;Dさん&quot;</span><span class="p">,</span><span class="s2">&quot;出身都道府県&quot;</span><span class="p">:</span><span class="s2">&quot;生年&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出身都道府県</th>
      <th>生年</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bさん</th>
      <td>Tochigi</td>
      <td>1993</td>
    </tr>
    <tr>
      <th>Cさん</th>
      <td>Hokkaido</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>Dさん</th>
      <td>Kyoto</td>
      <td>1989</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>といった具合。</p>
<p><code class="docutils literal notranslate"><span class="pre">loc</span></code>を使う場合、1:4や[1,2,3,4]はindexのスライスではなく、<br />
項目名を意味し、Eさんのデータも含まれている事がわかる。</p>
</section>
</section>
<section id="webdataframe">
<h2>Webページにある表をDataFrameとして取得する<a class="headerlink" href="#webdataframe" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>内の<code class="docutils literal notranslate"><span class="pre">read_html</span></code>関数を用いれば、<br />
Webページの中にある表をDataFrame形式で取得することもできます。</p>
<p>以下では例としてWikipediaの<a class="reference external" href="https://ja.wikipedia.org/wiki/%e3%83%8e%e3%83%bc%e3%83%99%e3%83%ab%e7%89%a9%e7%90%86%e5%ad%a6%e8%b3%9e">ノーベル物理学賞</a>のページにある、受賞者一覧を取得してみましょう</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://ja.wikipedia.org/wiki/</span><span class="si">%e</span><span class="s2">3</span><span class="si">%83%</span><span class="s2">8e</span><span class="si">%e</span><span class="s2">3</span><span class="si">%83%</span><span class="s2">bc</span><span class="si">%e</span><span class="s2">3</span><span class="si">%83%</span><span class="s2">99</span><span class="si">%e</span><span class="s2">3</span><span class="si">%83%</span><span class="s2">ab</span><span class="si">%e</span><span class="s2">7</span><span class="si">%89%</span><span class="s2">a9</span><span class="si">%e</span><span class="s2">7</span><span class="si">%90%</span><span class="s2">86</span><span class="si">%e</span><span class="s2">5</span><span class="si">%a</span><span class="s2">d</span><span class="si">%a</span><span class="s2">6</span><span class="si">%e</span><span class="s2">8%b3</span><span class="si">%9e</span><span class="s2">&quot;</span>
<span class="n">tables</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>表の数を数えてみると…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18
</pre></div>
</div>
</div>
</div>
<p>ページ内に、18個もの表があることがわかります。(ほとんどはwikipediaのテンプレート等)</p>
<p>たとえば、2010年代の受賞者のみに興味がある場合は</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>年度</th>
      <th>受賞者名</th>
      <th>受賞者名.1</th>
      <th>国籍</th>
      <th>受賞理由[4]・原著ないし関連論文</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010年</td>
      <td>NaN</td>
      <td>アンドレ・ガイム Andre Geim</td>
      <td>オランダ （ ロシア出身）</td>
      <td>二次元物質グラフェンに関する革新的実験[注 71]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010年</td>
      <td>NaN</td>
      <td>コンスタンチン・ノボセロフ Konstantin Novoselov</td>
      <td>ロシア  イギリス</td>
      <td>二次元物質グラフェンに関する革新的実験[注 71]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011年</td>
      <td>NaN</td>
      <td>ソール・パールマッター Saul Perlmutter</td>
      <td>アメリカ合衆国</td>
      <td>遠方の超新星の観測を通した宇宙の加速膨張の発見 Astrophys. J.: 517 (19...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011年</td>
      <td>NaN</td>
      <td>ブライアン・P・シュミット Brian Schmidt</td>
      <td>オーストラリア  アメリカ合衆国</td>
      <td>遠方の超新星の観測を通した宇宙の加速膨張の発見 Astrophys. J.: 517 (19...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011年</td>
      <td>NaN</td>
      <td>アダム・リース Adam Riess</td>
      <td>アメリカ合衆国</td>
      <td>遠方の超新星の観測を通した宇宙の加速膨張の発見 Astrophys. J.: 517 (19...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2012年</td>
      <td>NaN</td>
      <td>セルジュ・アロシュ Serge Haroche</td>
      <td>フランス （ モロッコ出身）</td>
      <td>個別の量子系に対する計測および制御[注 72]を可能にする画期的な実験的手法に関する業績[5...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2012年</td>
      <td>NaN</td>
      <td>デービッド・ワインランド David J. Wineland</td>
      <td>アメリカ合衆国</td>
      <td>個別の量子系に対する計測および制御[注 72]を可能にする画期的な実験的手法に関する業績[5...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2013年</td>
      <td>NaN</td>
      <td>フランソワ・アングレール François Englert</td>
      <td>ベルギー</td>
      <td>欧州原子核研究機構 (CERN) によって存在が確認された素粒子（ヒッグス粒子）に基づく、質...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2013年</td>
      <td>NaN</td>
      <td>ピーター・ヒッグス Peter Higgs</td>
      <td>イギリス</td>
      <td>欧州原子核研究機構 (CERN) によって存在が確認された素粒子（ヒッグス粒子）に基づく、質...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2014年</td>
      <td>NaN</td>
      <td>赤﨑勇 Isamu Akasaki</td>
      <td>日本</td>
      <td>高輝度で省電力の白色光源を実現可能にした青色発光ダイオードの発明[10]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2014年</td>
      <td>NaN</td>
      <td>天野浩 Hiroshi Amano</td>
      <td>日本</td>
      <td>高輝度で省電力の白色光源を実現可能にした青色発光ダイオードの発明[10]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2014年</td>
      <td>NaN</td>
      <td>中村修二 Shuji Nakamura</td>
      <td>アメリカ合衆国 （ 日本出身）</td>
      <td>高輝度で省電力の白色光源を実現可能にした青色発光ダイオードの発明[10]</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2015年</td>
      <td>NaN</td>
      <td>梶田隆章 Takaaki Kajita</td>
      <td>日本</td>
      <td>素粒子「ニュートリノ」が質量を持つことを示すニュートリノ振動の発見[11] Nucl. Ph...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2015年</td>
      <td>NaN</td>
      <td>アーサー・B・マクドナルド Arthur B. McDonald</td>
      <td>カナダ</td>
      <td>素粒子「ニュートリノ」が質量を持つことを示すニュートリノ振動の発見[11] Nucl. Ph...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2016年</td>
      <td>NaN</td>
      <td>デイヴィッド・J・サウレス David J. Thouless</td>
      <td>イギリス  アメリカ合衆国</td>
      <td>物質のトポロジカル相とトポロジカル相転移の理論的発見[12][13]</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2016年</td>
      <td>NaN</td>
      <td>ダンカン・ホールデン Duncan Haldane</td>
      <td>イギリス  スロベニア</td>
      <td>物質のトポロジカル相とトポロジカル相転移の理論的発見[12][13]</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2016年</td>
      <td>NaN</td>
      <td>ジョン・M・コステリッツ Michael Kosterlitz</td>
      <td>イギリス  アメリカ合衆国</td>
      <td>物質のトポロジカル相とトポロジカル相転移の理論的発見[12][13]</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2017年</td>
      <td>NaN</td>
      <td>レイナー・ワイス Rainer Weiss</td>
      <td>アメリカ合衆国 （ ドイツ出身）</td>
      <td>LIGO検出器および重力波の観測への決定的な貢献</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2017年</td>
      <td>NaN</td>
      <td>バリー・バリッシュ Barry Barish</td>
      <td>アメリカ合衆国</td>
      <td>LIGO検出器および重力波の観測への決定的な貢献</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2017年</td>
      <td>NaN</td>
      <td>キップ・ソーン Kip Thorne</td>
      <td>アメリカ合衆国</td>
      <td>LIGO検出器および重力波の観測への決定的な貢献</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2018年</td>
      <td>NaN</td>
      <td>アーサー・アシュキン Arthur Ashkin</td>
      <td>アメリカ合衆国</td>
      <td>光ピンセットの開発と生体システムへの応用</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2018年</td>
      <td>NaN</td>
      <td>ジェラール・ムル Gérard Mourou</td>
      <td>フランス</td>
      <td>超高出力・超短パルスレーザーの生成方法の開発</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2018年</td>
      <td>NaN</td>
      <td>ドナ・ストリックランド Donna Strickland</td>
      <td>カナダ</td>
      <td>超高出力・超短パルスレーザーの生成方法の開発</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2019年</td>
      <td>NaN</td>
      <td>ジェームズ・ピーブルス Jim Peebles</td>
      <td>アメリカ合衆国 （ カナダ出身）</td>
      <td>物理宇宙論における理論的発見</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2019年</td>
      <td>NaN</td>
      <td>ミシェル・マイヨール Michel Mayor</td>
      <td>スイス</td>
      <td>太陽型恒星を周回する太陽系外惑星の発見</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2019年</td>
      <td>NaN</td>
      <td>ディディエ・ケロー Didier Queloz</td>
      <td>スイス</td>
      <td>太陽型恒星を周回する太陽系外惑星の発見</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pandascsv-excel">
<h2>Pandasでcsv/Excelファイルを読み込む<a class="headerlink" href="#pandascsv-excel" title="Link to this heading">#</a></h2>
<section id="csv">
<h3>csvファイルの読み込み<a class="headerlink" href="#csv" title="Link to this heading">#</a></h3>
<p>pandasには、csvを読み込むための関数<code class="docutils literal notranslate"><span class="pre">read_csv</span></code>が用意されていて、ファイルパスを指定する他に、URLを指定して開く事ができる。</p>
<p><a class="reference external" href="https://www.nstac.go.jp/use/literacy/ssdse/">教育用標準データセット</a>の一つであるSSDSE-B(県別推移)を読み込んでみよう。</p>
<p>下を実行すると…実はエラーとなる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://www.nstac.go.jp/sys/files/SSDSE-B-2024.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">UnicodeDecodeError</span><span class="g g-Whitespace">                        </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://www.nstac.go.jp/sys/files/SSDSE-B-2024.csv&quot;</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.10/site-packages/pandas/io/parsers/readers.py:948,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">935</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">944</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">945</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">946</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">948</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.10/site-packages/pandas/io/parsers/readers.py:611,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">608</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">610</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">611</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">613</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">614</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File /usr/local/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1448,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1445</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1447</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1448</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1723,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1720</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1722</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1723</span>     <span class="k">return</span> <span class="n">mapping</span><span class="p">[</span><span class="n">engine</span><span class="p">](</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1724</span> <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1725</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /usr/local/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py:93,</span> in <span class="ni">CParserWrapper.__init__</span><span class="nt">(self, src, **kwds)</span>
<span class="g g-Whitespace">     </span><span class="mi">90</span> <span class="k">if</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;dtype_backend&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;pyarrow&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">91</span>     <span class="c1"># Fail here loudly instead of in cython after reading</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span>     <span class="n">import_optional_dependency</span><span class="p">(</span><span class="s2">&quot;pyarrow&quot;</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">93</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span> <span class="o">=</span> <span class="n">parsers</span><span class="o">.</span><span class="n">TextReader</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span> <span class="bp">self</span><span class="o">.</span><span class="n">unnamed_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span><span class="o">.</span><span class="n">unnamed_cols</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span> <span class="c1"># error: Cannot determine type of &#39;names&#39;</span>

<span class="nn">File parsers.pyx:579,</span> in <span class="ni">pandas._libs.parsers.TextReader.__cinit__</span><span class="nt">()</span>

<span class="nn">File parsers.pyx:668,</span> in <span class="ni">pandas._libs.parsers.TextReader._get_header</span><span class="nt">()</span>

<span class="nn">File parsers.pyx:879,</span> in <span class="ni">pandas._libs.parsers.TextReader._tokenize_rows</span><span class="nt">()</span>

<span class="nn">File parsers.pyx:890,</span> in <span class="ni">pandas._libs.parsers.TextReader._check_tokenize_status</span><span class="nt">()</span>

<span class="nn">File parsers.pyx:2050,</span> in <span class="ni">pandas._libs.parsers.raise_parser_error</span><span class="nt">()</span>

<span class="ne">UnicodeDecodeError</span>: &#39;utf-8&#39; codec can&#39;t decode byte 0x94 in position 748: invalid start byte
</pre></div>
</div>
</div>
</div>
<p>その原因は、ファイルの文字コードがShift-JISであるため。
デフォルトの<code class="docutils literal notranslate"><span class="pre">utf-8</span></code>以外で作成されたファイルを読み込む場合、エンコーディングを指定する必要がある。</p>
<p>“shift_jis”等としたいところだが、最近のShift-JISに対応するエンコーディングの指示は”cp932”である。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://www.nstac.go.jp/sys/files/SSDSE-B-2024.csv&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;cp932&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SSDSE-B-2024</th>
      <th>Code</th>
      <th>Prefecture</th>
      <th>A1101</th>
      <th>A110101</th>
      <th>A110102</th>
      <th>A1102</th>
      <th>A110201</th>
      <th>A110202</th>
      <th>A1301</th>
      <th>...</th>
      <th>L322101</th>
      <th>L322102</th>
      <th>L322103</th>
      <th>L322104</th>
      <th>L322105</th>
      <th>L322106</th>
      <th>L322107</th>
      <th>L322108</th>
      <th>L322109</th>
      <th>L322110</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>年度</td>
      <td>地域コード</td>
      <td>都道府県</td>
      <td>総人口</td>
      <td>総人口（男）</td>
      <td>総人口（女）</td>
      <td>日本人人口</td>
      <td>日本人人口（男）</td>
      <td>日本人人口（女）</td>
      <td>15歳未満人口</td>
      <td>...</td>
      <td>食料費（二人以上の世帯）</td>
      <td>住居費（二人以上の世帯）</td>
      <td>光熱・水道費（二人以上の世帯）</td>
      <td>家具・家事用品費（二人以上の世帯）</td>
      <td>被服及び履物費（二人以上の世帯）</td>
      <td>保健医療費（二人以上の世帯）</td>
      <td>交通・通信費（二人以上の世帯）</td>
      <td>教育費（二人以上の世帯）</td>
      <td>教養娯楽費（二人以上の世帯）</td>
      <td>その他の消費支出（二人以上の世帯）</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5183000</td>
      <td>2446000</td>
      <td>2737000</td>
      <td>5147000</td>
      <td>2429000</td>
      <td>2717000</td>
      <td>544000</td>
      <td>...</td>
      <td>71448</td>
      <td>22013</td>
      <td>26676</td>
      <td>9912</td>
      <td>8816</td>
      <td>13788</td>
      <td>30483</td>
      <td>9913</td>
      <td>23762</td>
      <td>51583</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5224614</td>
      <td>2465088</td>
      <td>2759526</td>
      <td>5151366</td>
      <td>2429697</td>
      <td>2721669</td>
      <td>555804</td>
      <td>...</td>
      <td>77680</td>
      <td>27305</td>
      <td>27309</td>
      <td>12255</td>
      <td>9227</td>
      <td>14251</td>
      <td>41407</td>
      <td>9394</td>
      <td>26539</td>
      <td>56316</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5259000</td>
      <td>2480000</td>
      <td>2780000</td>
      <td>5223000</td>
      <td>2464000</td>
      <td>2759000</td>
      <td>565000</td>
      <td>...</td>
      <td>72912</td>
      <td>20862</td>
      <td>26332</td>
      <td>9895</td>
      <td>10466</td>
      <td>16466</td>
      <td>42277</td>
      <td>8848</td>
      <td>29335</td>
      <td>57289</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5293000</td>
      <td>2495000</td>
      <td>2798000</td>
      <td>5262000</td>
      <td>2482000</td>
      <td>2780000</td>
      <td>577000</td>
      <td>...</td>
      <td>69044</td>
      <td>19089</td>
      <td>27012</td>
      <td>8845</td>
      <td>11517</td>
      <td>11437</td>
      <td>39308</td>
      <td>10825</td>
      <td>26991</td>
      <td>56984</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>596</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>597</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>598</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>599</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>600</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>601 rows × 112 columns</p>
</div></div></div>
</div>
<p>今の場合ファイルの(0から数えて)1行目にヘッダ(列名)にしたい情報があるので<code class="docutils literal notranslate"><span class="pre">header</span></code>オプションを指定する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nstac.go.jp/sys/files/SSDSE-B-2024.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;cp932&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>年度</th>
      <th>地域コード</th>
      <th>都道府県</th>
      <th>総人口</th>
      <th>総人口（男）</th>
      <th>総人口（女）</th>
      <th>日本人人口</th>
      <th>日本人人口（男）</th>
      <th>日本人人口（女）</th>
      <th>15歳未満人口</th>
      <th>...</th>
      <th>食料費（二人以上の世帯）</th>
      <th>住居費（二人以上の世帯）</th>
      <th>光熱・水道費（二人以上の世帯）</th>
      <th>家具・家事用品費（二人以上の世帯）</th>
      <th>被服及び履物費（二人以上の世帯）</th>
      <th>保健医療費（二人以上の世帯）</th>
      <th>交通・通信費（二人以上の世帯）</th>
      <th>教育費（二人以上の世帯）</th>
      <th>教養娯楽費（二人以上の世帯）</th>
      <th>その他の消費支出（二人以上の世帯）</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5183000.0</td>
      <td>2446000.0</td>
      <td>2737000.0</td>
      <td>5147000.0</td>
      <td>2429000.0</td>
      <td>2717000.0</td>
      <td>544000.0</td>
      <td>...</td>
      <td>71448.0</td>
      <td>22013.0</td>
      <td>26676.0</td>
      <td>9912.0</td>
      <td>8816.0</td>
      <td>13788.0</td>
      <td>30483.0</td>
      <td>9913.0</td>
      <td>23762.0</td>
      <td>51583.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5224614.0</td>
      <td>2465088.0</td>
      <td>2759526.0</td>
      <td>5151366.0</td>
      <td>2429697.0</td>
      <td>2721669.0</td>
      <td>555804.0</td>
      <td>...</td>
      <td>77680.0</td>
      <td>27305.0</td>
      <td>27309.0</td>
      <td>12255.0</td>
      <td>9227.0</td>
      <td>14251.0</td>
      <td>41407.0</td>
      <td>9394.0</td>
      <td>26539.0</td>
      <td>56316.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5259000.0</td>
      <td>2480000.0</td>
      <td>2780000.0</td>
      <td>5223000.0</td>
      <td>2464000.0</td>
      <td>2759000.0</td>
      <td>565000.0</td>
      <td>...</td>
      <td>72912.0</td>
      <td>20862.0</td>
      <td>26332.0</td>
      <td>9895.0</td>
      <td>10466.0</td>
      <td>16466.0</td>
      <td>42277.0</td>
      <td>8848.0</td>
      <td>29335.0</td>
      <td>57289.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5293000.0</td>
      <td>2495000.0</td>
      <td>2798000.0</td>
      <td>5262000.0</td>
      <td>2482000.0</td>
      <td>2780000.0</td>
      <td>577000.0</td>
      <td>...</td>
      <td>69044.0</td>
      <td>19089.0</td>
      <td>27012.0</td>
      <td>8845.0</td>
      <td>11517.0</td>
      <td>11437.0</td>
      <td>39308.0</td>
      <td>10825.0</td>
      <td>26991.0</td>
      <td>56984.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5325000.0</td>
      <td>2510000.0</td>
      <td>2815000.0</td>
      <td>5298000.0</td>
      <td>2499000.0</td>
      <td>2799000.0</td>
      <td>588000.0</td>
      <td>...</td>
      <td>69640.0</td>
      <td>24217.0</td>
      <td>25633.0</td>
      <td>10550.0</td>
      <td>11222.0</td>
      <td>12242.0</td>
      <td>39559.0</td>
      <td>9837.0</td>
      <td>26797.0</td>
      <td>57003.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>595</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>596</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>597</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>598</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>599</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>600 rows × 112 columns</p>
</div></div></div>
</div>
<p>都道府県の列から、都道府県の名前を取り出してみよう。ある行以降はNaNになっているので、それを除去する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;cp932&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>年度</th>
      <th>地域コード</th>
      <th>都道府県</th>
      <th>総人口</th>
      <th>総人口（男）</th>
      <th>総人口（女）</th>
      <th>日本人人口</th>
      <th>日本人人口（男）</th>
      <th>日本人人口（女）</th>
      <th>15歳未満人口</th>
      <th>...</th>
      <th>食料費（二人以上の世帯）</th>
      <th>住居費（二人以上の世帯）</th>
      <th>光熱・水道費（二人以上の世帯）</th>
      <th>家具・家事用品費（二人以上の世帯）</th>
      <th>被服及び履物費（二人以上の世帯）</th>
      <th>保健医療費（二人以上の世帯）</th>
      <th>交通・通信費（二人以上の世帯）</th>
      <th>教育費（二人以上の世帯）</th>
      <th>教養娯楽費（二人以上の世帯）</th>
      <th>その他の消費支出（二人以上の世帯）</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5183000.0</td>
      <td>2446000.0</td>
      <td>2737000.0</td>
      <td>5147000.0</td>
      <td>2429000.0</td>
      <td>2717000.0</td>
      <td>544000.0</td>
      <td>...</td>
      <td>71448.0</td>
      <td>22013.0</td>
      <td>26676.0</td>
      <td>9912.0</td>
      <td>8816.0</td>
      <td>13788.0</td>
      <td>30483.0</td>
      <td>9913.0</td>
      <td>23762.0</td>
      <td>51583.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5224614.0</td>
      <td>2465088.0</td>
      <td>2759526.0</td>
      <td>5151366.0</td>
      <td>2429697.0</td>
      <td>2721669.0</td>
      <td>555804.0</td>
      <td>...</td>
      <td>77680.0</td>
      <td>27305.0</td>
      <td>27309.0</td>
      <td>12255.0</td>
      <td>9227.0</td>
      <td>14251.0</td>
      <td>41407.0</td>
      <td>9394.0</td>
      <td>26539.0</td>
      <td>56316.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5259000.0</td>
      <td>2480000.0</td>
      <td>2780000.0</td>
      <td>5223000.0</td>
      <td>2464000.0</td>
      <td>2759000.0</td>
      <td>565000.0</td>
      <td>...</td>
      <td>72912.0</td>
      <td>20862.0</td>
      <td>26332.0</td>
      <td>9895.0</td>
      <td>10466.0</td>
      <td>16466.0</td>
      <td>42277.0</td>
      <td>8848.0</td>
      <td>29335.0</td>
      <td>57289.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5293000.0</td>
      <td>2495000.0</td>
      <td>2798000.0</td>
      <td>5262000.0</td>
      <td>2482000.0</td>
      <td>2780000.0</td>
      <td>577000.0</td>
      <td>...</td>
      <td>69044.0</td>
      <td>19089.0</td>
      <td>27012.0</td>
      <td>8845.0</td>
      <td>11517.0</td>
      <td>11437.0</td>
      <td>39308.0</td>
      <td>10825.0</td>
      <td>26991.0</td>
      <td>56984.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5325000.0</td>
      <td>2510000.0</td>
      <td>2815000.0</td>
      <td>5298000.0</td>
      <td>2499000.0</td>
      <td>2799000.0</td>
      <td>588000.0</td>
      <td>...</td>
      <td>69640.0</td>
      <td>24217.0</td>
      <td>25633.0</td>
      <td>10550.0</td>
      <td>11222.0</td>
      <td>12242.0</td>
      <td>39559.0</td>
      <td>9837.0</td>
      <td>26797.0</td>
      <td>57003.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>559</th>
      <td>2014.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1426000.0</td>
      <td>700000.0</td>
      <td>725000.0</td>
      <td>1416000.0</td>
      <td>695000.0</td>
      <td>721000.0</td>
      <td>249000.0</td>
      <td>...</td>
      <td>56734.0</td>
      <td>20998.0</td>
      <td>20722.0</td>
      <td>7509.0</td>
      <td>6622.0</td>
      <td>9531.0</td>
      <td>32302.0</td>
      <td>9016.0</td>
      <td>18570.0</td>
      <td>43864.0</td>
    </tr>
    <tr>
      <th>560</th>
      <td>2013.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1419000.0</td>
      <td>697000.0</td>
      <td>722000.0</td>
      <td>1410000.0</td>
      <td>692000.0</td>
      <td>718000.0</td>
      <td>249000.0</td>
      <td>...</td>
      <td>57278.0</td>
      <td>23557.0</td>
      <td>20499.0</td>
      <td>7335.0</td>
      <td>7398.0</td>
      <td>9281.0</td>
      <td>33976.0</td>
      <td>9714.0</td>
      <td>20199.0</td>
      <td>50418.0</td>
    </tr>
    <tr>
      <th>561</th>
      <td>2012.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1411000.0</td>
      <td>693000.0</td>
      <td>719000.0</td>
      <td>1403000.0</td>
      <td>688000.0</td>
      <td>715000.0</td>
      <td>248000.0</td>
      <td>...</td>
      <td>55499.0</td>
      <td>23731.0</td>
      <td>19756.0</td>
      <td>7353.0</td>
      <td>6856.0</td>
      <td>9948.0</td>
      <td>27855.0</td>
      <td>7769.0</td>
      <td>19324.0</td>
      <td>49890.0</td>
    </tr>
    <tr>
      <th>562</th>
      <td>2011.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1402000.0</td>
      <td>688000.0</td>
      <td>714000.0</td>
      <td>1395000.0</td>
      <td>684000.0</td>
      <td>711000.0</td>
      <td>247000.0</td>
      <td>...</td>
      <td>53193.0</td>
      <td>23454.0</td>
      <td>20645.0</td>
      <td>6136.0</td>
      <td>6855.0</td>
      <td>9775.0</td>
      <td>26806.0</td>
      <td>7489.0</td>
      <td>18818.0</td>
      <td>48762.0</td>
    </tr>
    <tr>
      <th>563</th>
      <td>2010.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1392818.0</td>
      <td>683328.0</td>
      <td>709490.0</td>
      <td>1377248.0</td>
      <td>675338.0</td>
      <td>701910.0</td>
      <td>246313.0</td>
      <td>...</td>
      <td>54297.0</td>
      <td>24269.0</td>
      <td>19706.0</td>
      <td>7306.0</td>
      <td>7538.0</td>
      <td>9127.0</td>
      <td>28479.0</td>
      <td>10577.0</td>
      <td>20140.0</td>
      <td>57283.0</td>
    </tr>
  </tbody>
</table>
<p>564 rows × 112 columns</p>
</div></div></div>
</div>
<p>あるいは、特定の列の特定の行がNaNかどうかを調べて除外してみると</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;cp932&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;都道府県&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>年度</th>
      <th>地域コード</th>
      <th>都道府県</th>
      <th>総人口</th>
      <th>総人口（男）</th>
      <th>総人口（女）</th>
      <th>日本人人口</th>
      <th>日本人人口（男）</th>
      <th>日本人人口（女）</th>
      <th>15歳未満人口</th>
      <th>...</th>
      <th>食料費（二人以上の世帯）</th>
      <th>住居費（二人以上の世帯）</th>
      <th>光熱・水道費（二人以上の世帯）</th>
      <th>家具・家事用品費（二人以上の世帯）</th>
      <th>被服及び履物費（二人以上の世帯）</th>
      <th>保健医療費（二人以上の世帯）</th>
      <th>交通・通信費（二人以上の世帯）</th>
      <th>教育費（二人以上の世帯）</th>
      <th>教養娯楽費（二人以上の世帯）</th>
      <th>その他の消費支出（二人以上の世帯）</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5183000.0</td>
      <td>2446000.0</td>
      <td>2737000.0</td>
      <td>5147000.0</td>
      <td>2429000.0</td>
      <td>2717000.0</td>
      <td>544000.0</td>
      <td>...</td>
      <td>71448.0</td>
      <td>22013.0</td>
      <td>26676.0</td>
      <td>9912.0</td>
      <td>8816.0</td>
      <td>13788.0</td>
      <td>30483.0</td>
      <td>9913.0</td>
      <td>23762.0</td>
      <td>51583.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5224614.0</td>
      <td>2465088.0</td>
      <td>2759526.0</td>
      <td>5151366.0</td>
      <td>2429697.0</td>
      <td>2721669.0</td>
      <td>555804.0</td>
      <td>...</td>
      <td>77680.0</td>
      <td>27305.0</td>
      <td>27309.0</td>
      <td>12255.0</td>
      <td>9227.0</td>
      <td>14251.0</td>
      <td>41407.0</td>
      <td>9394.0</td>
      <td>26539.0</td>
      <td>56316.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5259000.0</td>
      <td>2480000.0</td>
      <td>2780000.0</td>
      <td>5223000.0</td>
      <td>2464000.0</td>
      <td>2759000.0</td>
      <td>565000.0</td>
      <td>...</td>
      <td>72912.0</td>
      <td>20862.0</td>
      <td>26332.0</td>
      <td>9895.0</td>
      <td>10466.0</td>
      <td>16466.0</td>
      <td>42277.0</td>
      <td>8848.0</td>
      <td>29335.0</td>
      <td>57289.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5293000.0</td>
      <td>2495000.0</td>
      <td>2798000.0</td>
      <td>5262000.0</td>
      <td>2482000.0</td>
      <td>2780000.0</td>
      <td>577000.0</td>
      <td>...</td>
      <td>69044.0</td>
      <td>19089.0</td>
      <td>27012.0</td>
      <td>8845.0</td>
      <td>11517.0</td>
      <td>11437.0</td>
      <td>39308.0</td>
      <td>10825.0</td>
      <td>26991.0</td>
      <td>56984.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017.0</td>
      <td>R01000</td>
      <td>北海道</td>
      <td>5325000.0</td>
      <td>2510000.0</td>
      <td>2815000.0</td>
      <td>5298000.0</td>
      <td>2499000.0</td>
      <td>2799000.0</td>
      <td>588000.0</td>
      <td>...</td>
      <td>69640.0</td>
      <td>24217.0</td>
      <td>25633.0</td>
      <td>10550.0</td>
      <td>11222.0</td>
      <td>12242.0</td>
      <td>39559.0</td>
      <td>9837.0</td>
      <td>26797.0</td>
      <td>57003.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>559</th>
      <td>2014.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1426000.0</td>
      <td>700000.0</td>
      <td>725000.0</td>
      <td>1416000.0</td>
      <td>695000.0</td>
      <td>721000.0</td>
      <td>249000.0</td>
      <td>...</td>
      <td>56734.0</td>
      <td>20998.0</td>
      <td>20722.0</td>
      <td>7509.0</td>
      <td>6622.0</td>
      <td>9531.0</td>
      <td>32302.0</td>
      <td>9016.0</td>
      <td>18570.0</td>
      <td>43864.0</td>
    </tr>
    <tr>
      <th>560</th>
      <td>2013.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1419000.0</td>
      <td>697000.0</td>
      <td>722000.0</td>
      <td>1410000.0</td>
      <td>692000.0</td>
      <td>718000.0</td>
      <td>249000.0</td>
      <td>...</td>
      <td>57278.0</td>
      <td>23557.0</td>
      <td>20499.0</td>
      <td>7335.0</td>
      <td>7398.0</td>
      <td>9281.0</td>
      <td>33976.0</td>
      <td>9714.0</td>
      <td>20199.0</td>
      <td>50418.0</td>
    </tr>
    <tr>
      <th>561</th>
      <td>2012.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1411000.0</td>
      <td>693000.0</td>
      <td>719000.0</td>
      <td>1403000.0</td>
      <td>688000.0</td>
      <td>715000.0</td>
      <td>248000.0</td>
      <td>...</td>
      <td>55499.0</td>
      <td>23731.0</td>
      <td>19756.0</td>
      <td>7353.0</td>
      <td>6856.0</td>
      <td>9948.0</td>
      <td>27855.0</td>
      <td>7769.0</td>
      <td>19324.0</td>
      <td>49890.0</td>
    </tr>
    <tr>
      <th>562</th>
      <td>2011.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1402000.0</td>
      <td>688000.0</td>
      <td>714000.0</td>
      <td>1395000.0</td>
      <td>684000.0</td>
      <td>711000.0</td>
      <td>247000.0</td>
      <td>...</td>
      <td>53193.0</td>
      <td>23454.0</td>
      <td>20645.0</td>
      <td>6136.0</td>
      <td>6855.0</td>
      <td>9775.0</td>
      <td>26806.0</td>
      <td>7489.0</td>
      <td>18818.0</td>
      <td>48762.0</td>
    </tr>
    <tr>
      <th>563</th>
      <td>2010.0</td>
      <td>R47000</td>
      <td>沖縄県</td>
      <td>1392818.0</td>
      <td>683328.0</td>
      <td>709490.0</td>
      <td>1377248.0</td>
      <td>675338.0</td>
      <td>701910.0</td>
      <td>246313.0</td>
      <td>...</td>
      <td>54297.0</td>
      <td>24269.0</td>
      <td>19706.0</td>
      <td>7306.0</td>
      <td>7538.0</td>
      <td>9127.0</td>
      <td>28479.0</td>
      <td>10577.0</td>
      <td>20140.0</td>
      <td>57283.0</td>
    </tr>
  </tbody>
</table>
<p>564 rows × 112 columns</p>
</div></div></div>
</div>
<p>県名を取得したければ例えば</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefectures</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;都道府県&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prefectures</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;北海道&#39;, &#39;青森県&#39;, &#39;岩手県&#39;, &#39;宮城県&#39;, &#39;秋田県&#39;, &#39;山形県&#39;, &#39;福島県&#39;, &#39;茨城県&#39;, &#39;栃木県&#39;, &#39;群馬県&#39;, &#39;埼玉県&#39;, &#39;千葉県&#39;, &#39;東京都&#39;, &#39;神奈川県&#39;, &#39;新潟県&#39;, &#39;富山県&#39;, &#39;石川県&#39;, &#39;福井県&#39;, &#39;山梨県&#39;, &#39;長野県&#39;, &#39;岐阜県&#39;, &#39;静岡県&#39;, &#39;愛知県&#39;, &#39;三重県&#39;, &#39;滋賀県&#39;, &#39;京都府&#39;, &#39;大阪府&#39;, &#39;兵庫県&#39;, &#39;奈良県&#39;, &#39;和歌山県&#39;, &#39;鳥取県&#39;, &#39;島根県&#39;, &#39;岡山県&#39;, &#39;広島県&#39;, &#39;山口県&#39;, &#39;徳島県&#39;, &#39;香川県&#39;, &#39;愛媛県&#39;, &#39;高知県&#39;, &#39;福岡県&#39;, &#39;佐賀県&#39;, &#39;長崎県&#39;, &#39;熊本県&#39;, &#39;大分県&#39;, &#39;宮崎県&#39;, &#39;鹿児島県&#39;, &#39;沖縄県&#39;]
</pre></div>
</div>
</div>
</div>
<p>NaNの判定は少しトリッキーで、単純な二項演算子で判定しようとすると直感と異なる振る舞いになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nan同士を==で評価(しているつもり)&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan同士を==で評価(しているつもり) False
</pre></div>
</div>
</div>
</div>
<p>さきほどのデータの例で、都道府県列からNaNでないものを取っているつもり</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;cp932&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;都道府県&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span> <span class="p">][</span><span class="s2">&quot;都道府県&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;北海道&#39;, &#39;青森県&#39;, &#39;岩手県&#39;, &#39;宮城県&#39;, &#39;秋田県&#39;, &#39;山形県&#39;, &#39;福島県&#39;, &#39;茨城県&#39;, &#39;栃木県&#39;,
       &#39;群馬県&#39;, &#39;埼玉県&#39;, &#39;千葉県&#39;, &#39;東京都&#39;, &#39;神奈川県&#39;, &#39;新潟県&#39;, &#39;富山県&#39;, &#39;石川県&#39;, &#39;福井県&#39;,
       &#39;山梨県&#39;, &#39;長野県&#39;, &#39;岐阜県&#39;, &#39;静岡県&#39;, &#39;愛知県&#39;, &#39;三重県&#39;, &#39;滋賀県&#39;, &#39;京都府&#39;, &#39;大阪府&#39;,
       &#39;兵庫県&#39;, &#39;奈良県&#39;, &#39;和歌山県&#39;, &#39;鳥取県&#39;, &#39;島根県&#39;, &#39;岡山県&#39;, &#39;広島県&#39;, &#39;山口県&#39;, &#39;徳島県&#39;,
       &#39;香川県&#39;, &#39;愛媛県&#39;, &#39;高知県&#39;, &#39;福岡県&#39;, &#39;佐賀県&#39;, &#39;長崎県&#39;, &#39;熊本県&#39;, &#39;大分県&#39;, &#39;宮崎県&#39;,
       &#39;鹿児島県&#39;, &#39;沖縄県&#39;, nan], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Nanに対して定義された関数やメソッドを用いる必要がある。</p>
</section>
<section id="excel">
<h3>Excelファイルの読み込み<a class="headerlink" href="#excel" title="Link to this heading">#</a></h3>
<p>Pandasには<code class="docutils literal notranslate"><span class="pre">EXcelFile</span></code>や<code class="docutils literal notranslate"><span class="pre">read_excel</span></code>という関数が用意されていて、多数のシートを含むようなエクセルファイルを開くことも出来る。</p>
<p>今まではGoogle Driveにいれたファイルを読み出していたが、<br />
Webから直接xlsxファイルを読み込んでみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.mext.go.jp/content/20201225-mxt_kagsei-mext_01110_012.xlsx&quot;</span>
<span class="n">input_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>ブック内のシートの一覧は以下のように取得できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sheet_names</span> <span class="o">=</span> <span class="n">input_file</span><span class="o">.</span><span class="n">sheet_names</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pandas: シート名&quot;</span><span class="p">,</span><span class="n">sheet_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas: シート名 [&#39;表全体&#39;, &#39;1穀類&#39;, &#39;2いも及びでん粉類&#39;, &#39;3砂糖及び甘味類&#39;, &#39;4豆類&#39;, &#39;5種実類&#39;, &#39;6野菜類&#39;, &#39;7果実類&#39;, &#39;8きのこ類&#39;, &#39;9藻類&#39;, &#39;10魚介類&#39;, &#39;11肉類&#39;, &#39;12鶏卵&#39;, &#39;13乳類&#39;, &#39;14油脂類&#39;, &#39;15菓子類&#39;, &#39;16し好飲料&#39;, &#39;17調味料及び香辛料&#39;, &#39;18調理済み流通食品類&#39;]
</pre></div>
</div>
</div>
</div>
<p>シートを指定するのは、インデックスかシート名の文字列で行う。</p>
<p>“1 穀類”を使うことにして、<br />
pandasにあるread_excel関数を使ってみよう。<br />
read_excel関数の最初の引数にはパスの他に、urlも取れる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;1穀類&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 1</th>
      <th>Unnamed: 2</th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 4</th>
      <th>Unnamed: 5</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
      <th>...</th>
      <th>Unnamed: 52</th>
      <th>Unnamed: 53</th>
      <th>Unnamed: 54</th>
      <th>Unnamed: 55</th>
      <th>Unnamed: 56</th>
      <th>Unnamed: 57</th>
      <th>Unnamed: 58</th>
      <th>Unnamed: 59</th>
      <th>Unnamed: 60</th>
      <th>更新日：2021年12月28日</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>食　品　番　号</td>
      <td>索　引　番　号</td>
      <td>可　　食　　部　　 100　　g　　当　　た　　り</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>備　　考</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>食　品　名</td>
      <td>廃　棄　率</td>
      <td>エネルギー</td>
      <td>NaN</td>
      <td>水　分</td>
      <td>たんぱく質</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>アルコール</td>
      <td>食塩相当量</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>アミノ酸組成による\nたんぱく質</td>
      <td>たんぱく質</td>
      <td>...</td>
      <td>ナイアシン当量</td>
      <td>ビ\nタ\nミ\nン\nＢ６</td>
      <td>ビ\nタ\nミ\nン\nＢ１２</td>
      <td>葉　酸</td>
      <td>パントテン酸</td>
      <td>ビ オ チ ン</td>
      <td>ビタミンC</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>211</th>
      <td>1.0</td>
      <td>01139</td>
      <td>201</td>
      <td>ひえ　精白粒</td>
      <td>0</td>
      <td>1534</td>
      <td>361</td>
      <td>12.9</td>
      <td>8.4</td>
      <td>9.4</td>
      <td>...</td>
      <td>2.3</td>
      <td>0.17</td>
      <td>(0)</td>
      <td>14</td>
      <td>1.50</td>
      <td>3.6</td>
      <td>0</td>
      <td>-</td>
      <td>0</td>
      <td>歩留り： 55～60 %</td>
    </tr>
    <tr>
      <th>212</th>
      <td>1.0</td>
      <td>01140</td>
      <td>202</td>
      <td>もろこし　玄穀</td>
      <td>0</td>
      <td>1454</td>
      <td>344</td>
      <td>12.0</td>
      <td>(9.0)</td>
      <td>10.3</td>
      <td>...</td>
      <td>(8.0)</td>
      <td>0.31</td>
      <td>(0)</td>
      <td>54</td>
      <td>1.42</td>
      <td>15.0</td>
      <td>(0)</td>
      <td>-</td>
      <td>0</td>
      <td>別名： こうりゃん、ソルガム、たかきび、マイロ</td>
    </tr>
    <tr>
      <th>213</th>
      <td>1.0</td>
      <td>01141</td>
      <td>203</td>
      <td>もろこし　精白粒</td>
      <td>0</td>
      <td>1473</td>
      <td>348</td>
      <td>12.5</td>
      <td>(8.0)</td>
      <td>9.5</td>
      <td>...</td>
      <td>(5.0)</td>
      <td>0.24</td>
      <td>(0)</td>
      <td>29</td>
      <td>0.66</td>
      <td>-</td>
      <td>(0)</td>
      <td>-</td>
      <td>0</td>
      <td>別名： こうりゃん、ソルガム、たかきび、マイロ\n歩留り： 70～80 %</td>
    </tr>
    <tr>
      <th>214</th>
      <td>1.0</td>
      <td>01142</td>
      <td>204</td>
      <td>ライむぎ　全粒粉</td>
      <td>0</td>
      <td>1342</td>
      <td>317</td>
      <td>12.5</td>
      <td>10.8</td>
      <td>12.7</td>
      <td>...</td>
      <td>4.2</td>
      <td>0.22</td>
      <td>(0)</td>
      <td>65</td>
      <td>0.87</td>
      <td>9.5</td>
      <td>0</td>
      <td>-</td>
      <td>0</td>
      <td>別名：黒麦（くろむぎ）</td>
    </tr>
    <tr>
      <th>215</th>
      <td>1.0</td>
      <td>01143</td>
      <td>205</td>
      <td>ライむぎ　ライ麦粉</td>
      <td>0</td>
      <td>1368</td>
      <td>324</td>
      <td>13.5</td>
      <td>7.8</td>
      <td>8.5</td>
      <td>...</td>
      <td>2.6</td>
      <td>0.10</td>
      <td>(0)</td>
      <td>34</td>
      <td>0.63</td>
      <td>-</td>
      <td>(0)</td>
      <td>-</td>
      <td>0</td>
      <td>別名:黒麦（くろむぎ）\n歩留り： 65～75 %</td>
    </tr>
  </tbody>
</table>
<p>216 rows × 62 columns</p>
</div></div></div>
</div>
<p>同じものが得られている。</p>
<section id="id6">
<h4>Excelファイルの読み込みに関する補足<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>内部では<code class="docutils literal notranslate"><span class="pre">ExcelFile</span></code>というクラスがExcelファイルを扱うために用意されている。</p>
<p>Excelファイルが単一のシートしかない場合や、上でやったように<code class="docutils literal notranslate"><span class="pre">ExcelFile</span></code>化してシート名を既に知っている場合は、<code class="docutils literal notranslate"><span class="pre">read_excel</span></code>関数で直接読み込むことができ、DataFrameとして取得できる。</p>
<p>ファイルによっては、読み込む際にエラーが出ることがある。</p>
<p>その場合、<code class="docutils literal notranslate"><span class="pre">openpyxl</span></code>というライブラリをインストールすることで解決することがある。
以下のようにしてインストールし、<code class="docutils literal notranslate"><span class="pre">read_excel</span></code>のオプションとして<code class="docutils literal notranslate"><span class="pre">engine=&quot;openpyxl&quot;</span></code>を指定するとよい。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">openpyxl</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;filepath.xlsx&#39;</span><span class="p">,</span><span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Pythonには伝統的にExcelファイルを扱うためのライブラリが複数存在しており、pandasの内部でも用いられている。
中でも、ファイルを読み込む際に良く用いられてきたのが<code class="docutils literal notranslate"><span class="pre">xlrd</span></code>である。
pandasのバージョン1.1まではExcelファイルを扱う際、内部的に<code class="docutils literal notranslate"><span class="pre">xlrd</span></code>を使用していたが、v1.2からは<code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>形式は<code class="docutils literal notranslate"><span class="pre">openpyxl</span></code>、<code class="docutils literal notranslate"><span class="pre">.xls</span></code>は<code class="docutils literal notranslate"><span class="pre">xlrd</span></code>を使用するようになった。
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/whatsnew/v1.2.0.html">https://pandas.pydata.org/pandas-docs/stable/whatsnew/v1.2.0.html</a></p>
<p>したがって、使用している環境で<code class="docutils literal notranslate"><span class="pre">openpyxl</span></code>や<code class="docutils literal notranslate"><span class="pre">xlrd</span></code>などがなければインストールしたり、ファイルを読み込む際に明示的にengineを指定してやる必要がある。</p>
</section>
</section>
<section id="id7">
<h3>データの整形<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>次に、今取得したデータフレームのままでは少々扱い辛いので”整形”を考える。<br />
というのも前から4行ほど表示してみると…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 1</th>
      <th>Unnamed: 2</th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 4</th>
      <th>Unnamed: 5</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
      <th>...</th>
      <th>Unnamed: 52</th>
      <th>Unnamed: 53</th>
      <th>Unnamed: 54</th>
      <th>Unnamed: 55</th>
      <th>Unnamed: 56</th>
      <th>Unnamed: 57</th>
      <th>Unnamed: 58</th>
      <th>Unnamed: 59</th>
      <th>Unnamed: 60</th>
      <th>更新日：2021年12月28日</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>食　品　番　号</td>
      <td>索　引　番　号</td>
      <td>可　　食　　部　　 100　　g　　当　　た　　り</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>備　　考</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>食　品　名</td>
      <td>廃　棄　率</td>
      <td>エネルギー</td>
      <td>NaN</td>
      <td>水　分</td>
      <td>たんぱく質</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>アルコール</td>
      <td>食塩相当量</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>アミノ酸組成による\nたんぱく質</td>
      <td>たんぱく質</td>
      <td>...</td>
      <td>ナイアシン当量</td>
      <td>ビ\nタ\nミ\nン\nＢ６</td>
      <td>ビ\nタ\nミ\nン\nＢ１２</td>
      <td>葉　酸</td>
      <td>パントテン酸</td>
      <td>ビ オ チ ン</td>
      <td>ビタミンC</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 62 columns</p>
</div></div></div>
</div>
<p>最初の4行ほどに栄養素等の情報が入っているのだが、<br />
セルが結合されたりしているため、所々にNaNが入っていたりして見辛い。</p>
<p>(碁盤目の構造を破壊してしまうため「セルの結合」は機械的な処理と<br />
やや相性が悪く、プログラミングを用いたデータ分析では嫌われる)</p>
<p>各省庁の公開データのフォーマットの統一化は今後に期待することにして…<br />
まず以下の項目に該当する列だけを抽出する事を考える。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">,</span> <span class="s2">&quot;エネルギー&quot;</span><span class="p">,</span><span class="s2">&quot;たんぱく質&quot;</span><span class="p">,</span> <span class="s2">&quot;脂質&quot;</span><span class="p">,</span> <span class="s2">&quot;炭水化物&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>該当するデータがどの行・列に格納されているかをコードで指定するのは、<br />
前述のファイル構造の事情からやや面倒くさい。</p>
<p>以下では、その場しのぎ的ではあるが、<br />
興味のある量が何番目かを指定してまとめてみることにしよう。</p>
<p>そのために、1-2行目の要素を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#1-2行目(エクセルだと2行目)の要素から</span>
    <span class="c1">#半角空白, 全角空白(\u3000)や改行コード\nを取り除いたリストを作って表示してみる</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">tlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u3000</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="n">tmp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tlist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;食品名&#39;, &#39;廃棄率&#39;, &#39;エネルギー&#39;, &#39;nan&#39;, &#39;水分&#39;, &#39;たんぱく質&#39;, &#39;nan&#39;, &#39;脂質&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;炭水化物&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;有機酸&#39;, &#39;灰分&#39;, &#39;無機質&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;無機質&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;ビタミン&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;アルコール&#39;, &#39;食塩相当量&#39;, &#39;nan&#39;]
[&#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;アミノ酸組成によるたんぱく質&#39;, &#39;たんぱく質&#39;, &#39;脂肪酸のトリアシルグリセロール当量&#39;, &#39;コレステロール&#39;, &#39;脂質&#39;, &#39;利用可能炭水化物&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;食物繊維総量&#39;, &#39;糖アルコール&#39;, &#39;炭水化物&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;ナトリウム&#39;, &#39;カリウム&#39;, &#39;カルシウム&#39;, &#39;マグネシウム&#39;, &#39;リン&#39;, &#39;鉄&#39;, &#39;亜鉛&#39;, &#39;銅&#39;, &#39;マンガン&#39;, &#39;nan&#39;, &#39;ヨウ素&#39;, &#39;セレン&#39;, &#39;クロム&#39;, &#39;モリブデン&#39;, &#39;ビタミンA&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;ビタミンD&#39;, &#39;ビタミンE&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;ビタミンK&#39;, &#39;ビタミンＢ１&#39;, &#39;ビタミンB２&#39;, &#39;ナイアシン&#39;, &#39;ナイアシン当量&#39;, &#39;ビタミンＢ６&#39;, &#39;ビタミンＢ１２&#39;, &#39;葉酸&#39;, &#39;パントテン酸&#39;, &#39;ビオチン&#39;, &#39;ビタミンC&#39;, &#39;nan&#39;, &#39;nan&#39;, &#39;nan&#39;]
</pre></div>
</div>
</div>
</div>
<p>セルの結合により、興味のあるデータがどの列に記述されているかは注意が必要。</p>
<p>実際、[エネルギー]という文字列は1行目の6列目(それぞれインデックスでいうと0,5)で取得できるが、<br />
kJ単位になっていて、kcal単位でほしければ、7列目に格納された値が必要になる。</p>
<p>また、エクセルファイルを見るとわかるように、たんぱく質・脂質・炭水化物はさらに細分化されており、<br />
O列R列など、細かい列の分割が挿入されている. ~~これは大変困る~~</p>
<p>単純にたんぱく質・脂質・炭水化物と表記されている列のインデックスはそれぞれ9,12,20となる。<br />
食品名が格納されている列(3)、エネルギー[kJ単位] (6)と合わせて確認してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">targets</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 9</th>
      <th>Unnamed: 12</th>
      <th>Unnamed: 20</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>可　　食　　部　　 100　　g　　当　　た　　り</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>食　品　名</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>たんぱく質</td>
      <td>脂質</td>
      <td>炭水化物</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>211</th>
      <td>ひえ　精白粒</td>
      <td>361</td>
      <td>9.4</td>
      <td>3.3</td>
      <td>73.2</td>
    </tr>
    <tr>
      <th>212</th>
      <td>もろこし　玄穀</td>
      <td>344</td>
      <td>10.3</td>
      <td>4.7</td>
      <td>71.1</td>
    </tr>
    <tr>
      <th>213</th>
      <td>もろこし　精白粒</td>
      <td>348</td>
      <td>9.5</td>
      <td>2.6</td>
      <td>74.1</td>
    </tr>
    <tr>
      <th>214</th>
      <td>ライむぎ　全粒粉</td>
      <td>317</td>
      <td>12.7</td>
      <td>2.7</td>
      <td>70.7</td>
    </tr>
    <tr>
      <th>215</th>
      <td>ライむぎ　ライ麦粉</td>
      <td>324</td>
      <td>8.5</td>
      <td>1.6</td>
      <td>75.8</td>
    </tr>
  </tbody>
</table>
<p>216 rows × 5 columns</p>
</div></div></div>
</div>
<p>もう少し整形したいので、新しいデータフレームの列を書き換える。</p>
<p>食品名等が記載されているのは10行目以降なので、それを使いcolumnsを指定する。</p>
<p>さらに、食品名に含まれる余分な文字コードも削除しておこう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">targets</span><span class="p">]</span> 
<span class="n">ndf</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">10</span><span class="p">:,:]</span>
<span class="n">ndf</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">,</span><span class="s2">&quot;エネルギー(kcal)&quot;</span><span class="p">,</span><span class="s2">&quot;たんぱく質(g)&quot;</span><span class="p">,</span><span class="s2">&quot;脂質(g)&quot;</span><span class="p">,</span><span class="s2">&quot;炭水化物(g)&quot;</span><span class="p">]</span>
<span class="n">ndf</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndf</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u3000</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="c1"># 食品名の中にある余分な全角空白(\u3000)を半角スペースに置き換える</span>
<span class="n">ndf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>食品名</th>
      <th>エネルギー(kcal)</th>
      <th>たんぱく質(g)</th>
      <th>脂質(g)</th>
      <th>炭水化物(g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>成分識別子</td>
      <td>ENERC_KCAL</td>
      <td>PROT-</td>
      <td>FAT-</td>
      <td>CHOCDF-</td>
    </tr>
    <tr>
      <th>11</th>
      <td>アマランサス 玄穀</td>
      <td>343</td>
      <td>12.7</td>
      <td>6.0</td>
      <td>64.9</td>
    </tr>
    <tr>
      <th>12</th>
      <td>あわ 精白粒</td>
      <td>346</td>
      <td>11.2</td>
      <td>4.4</td>
      <td>69.7</td>
    </tr>
    <tr>
      <th>13</th>
      <td>あわ あわもち</td>
      <td>210</td>
      <td>5.1</td>
      <td>1.3</td>
      <td>45.3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>えんばく オートミール</td>
      <td>350</td>
      <td>13.7</td>
      <td>5.7</td>
      <td>69.1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>211</th>
      <td>ひえ 精白粒</td>
      <td>361</td>
      <td>9.4</td>
      <td>3.3</td>
      <td>73.2</td>
    </tr>
    <tr>
      <th>212</th>
      <td>もろこし 玄穀</td>
      <td>344</td>
      <td>10.3</td>
      <td>4.7</td>
      <td>71.1</td>
    </tr>
    <tr>
      <th>213</th>
      <td>もろこし 精白粒</td>
      <td>348</td>
      <td>9.5</td>
      <td>2.6</td>
      <td>74.1</td>
    </tr>
    <tr>
      <th>214</th>
      <td>ライむぎ 全粒粉</td>
      <td>317</td>
      <td>12.7</td>
      <td>2.7</td>
      <td>70.7</td>
    </tr>
    <tr>
      <th>215</th>
      <td>ライむぎ ライ麦粉</td>
      <td>324</td>
      <td>8.5</td>
      <td>1.6</td>
      <td>75.8</td>
    </tr>
  </tbody>
</table>
<p>206 rows × 5 columns</p>
</div></div></div>
</div>
<p>次に、食品名の一覧を取得した後、興味のあるもの(日常的に馴染みのあるもの)だけを<br />
ピックアップしてみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ndf</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;成分識別子&#39;, &#39;アマランサス 玄穀&#39;, &#39;あわ 精白粒&#39;, &#39;あわ あわもち&#39;, &#39;えんばく オートミール&#39;, &#39;おおむぎ 七分つき押麦&#39;, &#39;おおむぎ 押麦 乾&#39;, &#39;おおむぎ 押麦 めし&#39;, &#39;おおむぎ 米粒麦&#39;, &#39;おおむぎ 大麦めん 乾&#39;, &#39;おおむぎ 大麦めん ゆで&#39;, &#39;おおむぎ 麦こがし&#39;, &#39;キヌア 玄穀&#39;, &#39;きび 精白粒&#39;, &#39;こむぎ ［玄穀］ 国産 普通&#39;, &#39;こむぎ ［玄穀］ 輸入 軟質&#39;, &#39;こむぎ ［玄穀］ 輸入 硬質&#39;, &#39;こむぎ ［小麦粉］ 薄力粉 1等&#39;, &#39;こむぎ ［小麦粉］ 薄力粉 2等&#39;, &#39;こむぎ ［小麦粉］ 中力粉 1等&#39;, &#39;こむぎ ［小麦粉］ 中力粉 2等&#39;, &#39;こむぎ ［小麦粉］ 強力粉 1等&#39;, &#39;こむぎ ［小麦粉］ 強力粉 2等&#39;, &#39;こむぎ ［小麦粉］ 強力粉 全粒粉&#39;, &#39;こむぎ ［小麦粉］ プレミックス粉 お好み焼き用&#39;, &#39;こむぎ ［小麦粉］ プレミックス粉 ホットケーキ用&#39;, &#39;こむぎ ［小麦粉］ プレミックス粉 から揚げ用&#39;, &#39;こむぎ ［小麦粉］ プレミックス粉 天ぷら用&#39;, &#39;こむぎ ［小麦粉］ プレミックス粉 天ぷら用 バッター&#39;, &#39;こむぎ ［小麦粉］ プレミックス粉 天ぷら用 バッター 揚げ&#39;, &#39;こむぎ ［パン類］ 角形食パン 食パン&#39;, &#39;こむぎ ［パン類］ 角形食パン 焼き&#39;, &#39;こむぎ ［パン類］ 角形食パン 耳を除いたもの&#39;, &#39;こむぎ ［パン類］ 角形食パン 耳&#39;, &#39;こむぎ ［パン類］ 食パン リーンタイプ&#39;, &#39;こむぎ ［パン類］ 食パン リッチタイプ&#39;, &#39;こむぎ ［パン類］ 山形食パン 食パン&#39;, &#39;こむぎ ［パン類］ コッペパン&#39;, &#39;こむぎ ［パン類］ 乾パン&#39;, &#39;こむぎ ［パン類］ フランスパン&#39;, &#39;こむぎ ［パン類］ ライ麦パン&#39;, &#39;こむぎ ［パン類］ 全粒粉パン&#39;, &#39;こむぎ ［パン類］ ぶどうパン&#39;, &#39;こむぎ ［パン類］ ロールパン&#39;, &#39;こむぎ ［パン類］ クロワッサン レギュラータイプ&#39;, &#39;こむぎ ［パン類］ クロワッサン リッチタイプ&#39;, &#39;こむぎ ［パン類］ くるみパン&#39;, &#39;こむぎ ［パン類］ イングリッシュマフィン&#39;, &#39;こむぎ ［パン類］ ナン&#39;, &#39;こむぎ ［パン類］ ベーグル&#39;, &#39;こむぎ ［うどん・そうめん類］ うどん 生&#39;, &#39;こむぎ ［うどん・そうめん類］ うどん ゆで&#39;, &#39;こむぎ ［うどん・そうめん類］ うどん 半生うどん&#39;, &#39;こむぎ ［うどん・そうめん類］ 干しうどん 乾&#39;, &#39;こむぎ ［うどん・そうめん類］ 干しうどん ゆで&#39;, &#39;こむぎ ［うどん・そうめん類］ そうめん・ひやむぎ 乾&#39;, &#39;こむぎ ［うどん・そうめん類］ そうめん・ひやむぎ ゆで&#39;, &#39;こむぎ ［うどん・そうめん類］ 手延そうめん・手延ひやむぎ 乾&#39;, &#39;こむぎ ［うどん・そうめん類］ 手延そうめん・手延ひやむぎ ゆで&#39;, &#39;こむぎ ［中華めん類］ 中華めん 生&#39;, &#39;こむぎ ［中華めん類］ 中華めん ゆで&#39;, &#39;こむぎ ［中華めん類］ 半生中華めん &#39;, &#39;こむぎ ［中華めん類］ 蒸し中華めん 蒸し中華めん&#39;, &#39;こむぎ ［中華めん類］ 蒸し中華めん  ソテー&#39;, &#39;こむぎ ［中華めん類］ 干し中華めん 乾&#39;, &#39;こむぎ ［中華めん類］ 干し中華めん ゆで&#39;, &#39;こむぎ ［中華めん類］ 沖縄そば 生&#39;, &#39;こむぎ ［中華めん類］ 沖縄そば ゆで&#39;, &#39;こむぎ ［中華めん類］ 干し沖縄そば 乾&#39;, &#39;こむぎ ［中華めん類］ 干し沖縄そば ゆで&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 油揚げ味付け&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 油揚げ 乾 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 油揚げ 調理後全体 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 油揚げ ゆで （添付調味料等を含まないもの）&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 油揚げ 乾 （添付調味料等を含まないもの）&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 非油揚げ 乾 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 非油揚げ 調理後全体 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 非油揚げ ゆで （添付調味料等を含まないもの）&#39;, &#39;こむぎ ［即席めん類］ 即席中華めん 非油揚げ 乾 （添付調味料等を含まないもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 油揚げ 塩味 乾 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 油揚げ 塩味 調理後全体 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 油揚げ 塩味 調理後のめん （スープを残したもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 油揚げ しょうゆ味 乾 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 油揚げ しょうゆ味 調理後全体 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 油揚げ しょうゆ味 調理後のめん （スープを残したもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 油揚げ 焼きそば 乾 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 油揚げ 焼きそば 調理後全体 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 非油揚げ 乾 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 非油揚げ 調理後全体 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 中華スタイル即席カップめん 非油揚げ 調理後のめん （スープを残したもの）&#39;, &#39;こむぎ ［即席めん類］ 和風スタイル即席カップめん 油揚げ 乾 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 和風スタイル即席カップめん 油揚げ 調理後全体 （添付調味料等を含むもの）&#39;, &#39;こむぎ ［即席めん類］ 和風スタイル即席カップめん 油揚げ 調理後のめん （スープを残したもの）&#39;, &#39;こむぎ ［マカロニ・スパゲッティ類］ マカロニ・スパゲッティ 乾&#39;, &#39;こむぎ ［マカロニ・スパゲッティ類］ マカロニ・スパゲッティ ゆで&#39;, &#39;こむぎ ［マカロニ・スパゲッティ類］ マカロニ・スパゲッティ ソテー&#39;, &#39;こむぎ ［マカロニ・スパゲッティ類］ 生パスタ 生&#39;, &#39;こむぎ ［ふ類］ 生ふ&#39;, &#39;こむぎ ［ふ類］ 焼きふ 釜焼きふ&#39;, &#39;こむぎ ［ふ類］ 焼きふ 板ふ&#39;, &#39;こむぎ ［ふ類］ 焼きふ 車ふ&#39;, &#39;こむぎ ［ふ類］ 油ふ&#39;, &#39;こむぎ ［その他］ 小麦はいが&#39;, &#39;こむぎ ［その他］ 小麦たんぱく 粉末状&#39;, &#39;こむぎ ［その他］ 小麦たんぱく 粒状&#39;, &#39;こむぎ ［その他］ 小麦たんぱく ペースト状&#39;, &#39;こむぎ ［その他］ かやきせんべい&#39;, &#39;こむぎ ［その他］ ぎょうざの皮 生&#39;, &#39;こむぎ ［その他］ しゅうまいの皮 生&#39;, &#39;こむぎ ［その他］ 春巻きの皮 生&#39;, &#39;こむぎ ［その他］ 春巻きの皮 揚げ&#39;, &#39;こむぎ ［その他］ ピザ生地&#39;, &#39;こむぎ ［その他］ ちくわぶ&#39;, &#39;こむぎ ［その他］ パン粉 生&#39;, &#39;こむぎ ［その他］ パン粉 半生&#39;, &#39;こむぎ ［その他］ パン粉 乾燥&#39;, &#39;こむぎ ［その他］ 冷めん 生&#39;, &#39;こめ ［水稲穀粒］ 玄米&#39;, &#39;こめ ［水稲穀粒］ 半つき米&#39;, &#39;こめ ［水稲穀粒］ 七分つき米&#39;, &#39;こめ ［水稲穀粒］ 精白米 うるち米&#39;, &#39;こめ ［水稲穀粒］ 精白米 もち米&#39;, &#39;こめ ［水稲穀粒］ 精白米 インディカ米&#39;, &#39;こめ ［水稲穀粒］ はいが精米&#39;, &#39;こめ ［水稲穀粒］ 発芽玄米&#39;, &#39;こめ ［水稲穀粒］ 赤米&#39;, &#39;こめ ［水稲穀粒］ 黒米&#39;, &#39;こめ ［水稲めし］ 玄米&#39;, &#39;こめ ［水稲めし］ 半つき米&#39;, &#39;こめ ［水稲めし］ 七分つき米&#39;, &#39;こめ ［水稲めし］ 精白米 インディカ米&#39;, &#39;こめ ［水稲めし］ 精白米 うるち米&#39;, &#39;こめ ［水稲めし］ 精白米 もち米&#39;, &#39;こめ ［水稲めし］ はいが精米&#39;, &#39;こめ ［水稲めし］ 発芽玄米&#39;, &#39;こめ ［水稲めし］ 赤米&#39;, &#39;こめ ［水稲めし］ 黒米&#39;, &#39;こめ ［水稲軟めし］ 精白米&#39;, &#39;こめ ［水稲全かゆ］ 玄米&#39;, &#39;こめ ［水稲全かゆ］ 半つき米&#39;, &#39;こめ ［水稲全かゆ］ 七分つき米&#39;, &#39;こめ ［水稲全かゆ］ 精白米&#39;, &#39;こめ ［水稲五分かゆ］ 玄米&#39;, &#39;こめ ［水稲五分かゆ］ 半つき米&#39;, &#39;こめ ［水稲五分かゆ］ 七分つき米&#39;, &#39;こめ ［水稲五分かゆ］ 精白米&#39;, &#39;こめ ［水稲おもゆ］ 玄米&#39;, &#39;こめ ［水稲おもゆ］ 半つき米&#39;, &#39;こめ ［水稲おもゆ］ 七分つき米&#39;, &#39;こめ ［水稲おもゆ］ 精白米&#39;, &#39;こめ ［陸稲穀粒］ 玄米&#39;, &#39;こめ ［陸稲穀粒］ 半つき米&#39;, &#39;こめ ［陸稲穀粒］ 七分つき米&#39;, &#39;こめ ［陸稲穀粒］ 精白米&#39;, &#39;こめ ［陸稲めし］ 玄米&#39;, &#39;こめ ［陸稲めし］ 半つき米&#39;, &#39;こめ ［陸稲めし］ 七分つき米&#39;, &#39;こめ ［陸稲めし］ 精白米&#39;, &#39;こめ ［うるち米製品］ アルファ化米 一般用&#39;, &#39;こめ ［うるち米製品］ アルファ化米 学校給食用強化品&#39;, &#39;こめ ［うるち米製品］ おにぎり&#39;, &#39;こめ ［うるち米製品］ 焼きおにぎり&#39;, &#39;こめ ［うるち米製品］ きりたんぽ&#39;, &#39;こめ ［うるち米製品］ 上新粉&#39;, &#39;こめ ［うるち米製品］ 玄米粉&#39;, &#39;こめ ［うるち米製品］ 米粉&#39;, &#39;こめ ［うるち米製品］ 米粉パン 食パン&#39;, &#39;こめ ［うるち米製品］ 米粉パン ロールパン&#39;, &#39;こめ ［うるち米製品］ 米粉パン 小麦グルテン不使用のもの&#39;, &#39;こめ ［うるち米製品］ 米粉めん&#39;, &#39;こめ ［うるち米製品］ ビーフン&#39;, &#39;こめ ［うるち米製品］ ライスペーパー&#39;, &#39;こめ ［うるち米製品］ 米こうじ&#39;, &#39;こめ ［もち米製品］ もち&#39;, &#39;こめ ［もち米製品］ 赤飯&#39;, &#39;こめ ［もち米製品］ あくまき&#39;, &#39;こめ ［もち米製品］ 白玉粉&#39;, &#39;こめ ［もち米製品］ 道明寺粉&#39;, &#39;こめ ［その他］ 米ぬか&#39;, &#39;そば そば粉 全層粉&#39;, &#39;そば そば粉 内層粉&#39;, &#39;そば そば粉 中層粉&#39;, &#39;そば そば粉 表層粉&#39;, &#39;そば そば米&#39;, &#39;そば そば 生&#39;, &#39;そば そば ゆで&#39;, &#39;そば そば 半生そば&#39;, &#39;そば 干しそば 乾&#39;, &#39;そば 干しそば ゆで&#39;, &#39;とうもろこし 玄穀 黄色種&#39;, &#39;とうもろこし 玄穀 白色種&#39;, &#39;とうもろこし コーンミール 黄色種&#39;, &#39;とうもろこし コーンミール 白色種&#39;, &#39;とうもろこし コーングリッツ 黄色種&#39;, &#39;とうもろこし コーングリッツ 白色種&#39;, &#39;とうもろこし コーンフラワー 黄色種&#39;, &#39;とうもろこし コーンフラワー 白色種&#39;, &#39;とうもろこし ジャイアントコーン フライ 味付け&#39;, &#39;とうもろこし ポップコーン&#39;, &#39;とうもろこし コーンフレーク&#39;, &#39;はとむぎ 精白粒&#39;, &#39;ひえ 精白粒&#39;, &#39;もろこし 玄穀&#39;, &#39;もろこし 精白粒&#39;, &#39;ライむぎ 全粒粉&#39;, &#39;ライむぎ ライ麦粉&#39;]
</pre></div>
</div>
</div>
</div>
<p>この中から…</p>
<ul class="simple">
<li><p>こむぎ［パン類］食パンリッチタイプ</p></li>
<li><p>こむぎ［パン類］フランスパン</p></li>
<li><p>こめ［水稲軟めし］精白米</p></li>
<li><p>そばそばゆで</p></li>
<li><p>こむぎ［うどん・そうめん類］うどんゆで</p></li>
</ul>
<p>のみに興味があれば</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tshokuhin</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;こむぎ ［パン類］ 食パン リッチタイプ&quot;</span><span class="p">,</span><span class="s2">&quot;こむぎ ［パン類］ フランスパン&quot;</span><span class="p">,</span><span class="s2">&quot;こめ ［水稲軟めし］ 精白米&quot;</span><span class="p">,</span> <span class="s2">&quot;そば そば ゆで&quot;</span><span class="p">,</span> <span class="s2">&quot;こむぎ ［うどん・そうめん類］ うどん ゆで&quot;</span><span class="p">]</span>
<span class="n">ndf</span><span class="p">[</span> <span class="n">ndf</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">tshokuhin</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>食品名</th>
      <th>エネルギー(kcal)</th>
      <th>たんぱく質(g)</th>
      <th>脂質(g)</th>
      <th>炭水化物(g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>45</th>
      <td>こむぎ ［パン類］ 食パン リッチタイプ</td>
      <td>256</td>
      <td>(7.8)</td>
      <td>(6.0)</td>
      <td>(45.6)</td>
    </tr>
    <tr>
      <th>49</th>
      <td>こむぎ ［パン類］ フランスパン</td>
      <td>289</td>
      <td>9.4</td>
      <td>1.3</td>
      <td>57.5</td>
    </tr>
    <tr>
      <th>61</th>
      <td>こむぎ ［うどん・そうめん類］ うどん ゆで</td>
      <td>95</td>
      <td>2.6</td>
      <td>0.4</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>147</th>
      <td>こめ ［水稲軟めし］ 精白米</td>
      <td>113</td>
      <td>(1.8)</td>
      <td>(0.3)</td>
      <td>(26.4)</td>
    </tr>
    <tr>
      <th>195</th>
      <td>そば そば ゆで</td>
      <td>130</td>
      <td>4.8</td>
      <td>1.0</td>
      <td>26.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>などとする。</p>
<p>‘6野菜類’でも同様に…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;6野菜類&quot;</span><span class="p">)</span>
<span class="n">df6</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">20</span><span class="p">]]</span>
<span class="n">ndf6</span> <span class="o">=</span> <span class="n">df6</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">20</span><span class="p">]]</span> 
<span class="n">ndf6</span> <span class="o">=</span> <span class="n">ndf6</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">10</span><span class="p">:,:]</span>
<span class="n">ndf6</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">,</span><span class="s2">&quot;エネルギー(kcal)&quot;</span><span class="p">,</span><span class="s2">&quot;たんぱく質(g)&quot;</span><span class="p">,</span><span class="s2">&quot;脂質(g)&quot;</span><span class="p">,</span><span class="s2">&quot;炭水化物(g)&quot;</span><span class="p">]</span>
<span class="n">ndf6</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndf6</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u3000</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span> 
<span class="n">ndf6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>食品名</th>
      <th>エネルギー(kcal)</th>
      <th>たんぱく質(g)</th>
      <th>脂質(g)</th>
      <th>炭水化物(g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>成分識別子</td>
      <td>ENERC_KCAL</td>
      <td>PROT-</td>
      <td>FAT-</td>
      <td>CHOCDF-</td>
    </tr>
    <tr>
      <th>11</th>
      <td>アーティチョーク 花らい 生</td>
      <td>39</td>
      <td>2.3</td>
      <td>0.2</td>
      <td>11.3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>アーティチョーク 花らい ゆで</td>
      <td>35</td>
      <td>2.1</td>
      <td>0.1</td>
      <td>10.8</td>
    </tr>
    <tr>
      <th>13</th>
      <td>あさつき 葉 生</td>
      <td>34</td>
      <td>4.2</td>
      <td>0.3</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>14</th>
      <td>あさつき 葉 ゆで</td>
      <td>41</td>
      <td>4.2</td>
      <td>0.3</td>
      <td>7.3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>407</th>
      <td>（その他） ミックスベジタブル 冷凍</td>
      <td>67</td>
      <td>3.0</td>
      <td>0.7</td>
      <td>15.1</td>
    </tr>
    <tr>
      <th>408</th>
      <td>（その他） ミックスベジタブル 冷凍 ゆで</td>
      <td>65</td>
      <td>3.1</td>
      <td>0.8</td>
      <td>14.6</td>
    </tr>
    <tr>
      <th>409</th>
      <td>（その他） ミックスベジタブル 冷凍 油いため</td>
      <td>108</td>
      <td>3.3</td>
      <td>4.9</td>
      <td>15.7</td>
    </tr>
    <tr>
      <th>410</th>
      <td>（その他） 野菜ミックスジュース 通常タイプ</td>
      <td>21</td>
      <td>0.8</td>
      <td>0.1</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>411</th>
      <td>（その他） 野菜ミックスジュース 濃縮タイプ</td>
      <td>36</td>
      <td>1.0</td>
      <td>0.3</td>
      <td>7.8</td>
    </tr>
  </tbody>
</table>
<p>402 rows × 5 columns</p>
</div></div></div>
</div>
<p>特定のキーワードを含むものを全て取得して、<br />
食品名を細かく指定したり、対応する行番号のインデックスを取得できたりする</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kyabetu</span> <span class="o">=</span> <span class="n">ndf6</span><span class="p">[</span><span class="n">ndf6</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;キャベツ&#39;</span><span class="p">)]</span>
<span class="n">kyabetu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>食品名</th>
      <th>エネルギー(kcal)</th>
      <th>たんぱく質(g)</th>
      <th>脂質(g)</th>
      <th>炭水化物(g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>81</th>
      <td>（キャベツ類） キャベツ 結球葉 生</td>
      <td>21</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>（キャベツ類） キャベツ 結球葉 ゆで</td>
      <td>19</td>
      <td>0.9</td>
      <td>0.2</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>83</th>
      <td>（キャベツ類） キャベツ 結球葉 油いため</td>
      <td>78</td>
      <td>1.6</td>
      <td>6.0</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>84</th>
      <td>（キャベツ類） グリーンボール 結球葉 生</td>
      <td>20</td>
      <td>1.4</td>
      <td>0.1</td>
      <td>4.3</td>
    </tr>
    <tr>
      <th>85</th>
      <td>（キャベツ類） レッドキャベツ 結球葉 生</td>
      <td>30</td>
      <td>2.0</td>
      <td>0.1</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>358</th>
      <td>めキャベツ 結球葉 生</td>
      <td>52</td>
      <td>5.7</td>
      <td>0.1</td>
      <td>9.9</td>
    </tr>
    <tr>
      <th>359</th>
      <td>めキャベツ 結球葉 ゆで</td>
      <td>51</td>
      <td>5.3</td>
      <td>0.1</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tomato</span> <span class="o">=</span> <span class="n">ndf6</span><span class="p">[</span><span class="n">ndf6</span><span class="p">[</span><span class="s2">&quot;食品名&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;トマト&#39;</span><span class="p">)]</span>
<span class="n">tomato</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>食品名</th>
      <th>エネルギー(kcal)</th>
      <th>たんぱく質(g)</th>
      <th>脂質(g)</th>
      <th>炭水化物(g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>221</th>
      <td>（トマト類） 赤色トマト 果実 生</td>
      <td>20</td>
      <td>0.7</td>
      <td>0.1</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>222</th>
      <td>（トマト類） 赤色ミニトマト 果実 生</td>
      <td>30</td>
      <td>1.1</td>
      <td>0.1</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>223</th>
      <td>（トマト類） 黄色トマト 果実 生</td>
      <td>18</td>
      <td>1.1</td>
      <td>0.4</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>224</th>
      <td>（トマト類） ドライトマト</td>
      <td>291</td>
      <td>14.2</td>
      <td>2.1</td>
      <td>67.3</td>
    </tr>
    <tr>
      <th>225</th>
      <td>（トマト類） 加工品 ホール 食塩無添加</td>
      <td>21</td>
      <td>0.9</td>
      <td>0.2</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>226</th>
      <td>（トマト類） 加工品 トマトジュース 食塩添加</td>
      <td>15</td>
      <td>0.7</td>
      <td>0.1</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>227</th>
      <td>（トマト類） 加工品 トマトジュース 食塩無添加</td>
      <td>18</td>
      <td>0.7</td>
      <td>0.1</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>228</th>
      <td>（トマト類） 加工品 ミックスジュース 食塩添加</td>
      <td>18</td>
      <td>0.6</td>
      <td>0</td>
      <td>4.3</td>
    </tr>
    <tr>
      <th>229</th>
      <td>（トマト類） 加工品 ミックスジュース 食塩無添加</td>
      <td>18</td>
      <td>0.6</td>
      <td>0</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>DataFrame同士を結合してまとめるなどして扱いやすいデータに整形していく.</p>
<p>縦方向の結合はpandasのconcat(concatenateの略)を使う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">kyabetu</span><span class="p">,</span> <span class="n">tomato</span><span class="p">])</span>
<span class="n">tdf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>食品名</th>
      <th>エネルギー(kcal)</th>
      <th>たんぱく質(g)</th>
      <th>脂質(g)</th>
      <th>炭水化物(g)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>81</th>
      <td>（キャベツ類） キャベツ 結球葉 生</td>
      <td>21</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>（キャベツ類） キャベツ 結球葉 ゆで</td>
      <td>19</td>
      <td>0.9</td>
      <td>0.2</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>83</th>
      <td>（キャベツ類） キャベツ 結球葉 油いため</td>
      <td>78</td>
      <td>1.6</td>
      <td>6.0</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>84</th>
      <td>（キャベツ類） グリーンボール 結球葉 生</td>
      <td>20</td>
      <td>1.4</td>
      <td>0.1</td>
      <td>4.3</td>
    </tr>
    <tr>
      <th>85</th>
      <td>（キャベツ類） レッドキャベツ 結球葉 生</td>
      <td>30</td>
      <td>2.0</td>
      <td>0.1</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>358</th>
      <td>めキャベツ 結球葉 生</td>
      <td>52</td>
      <td>5.7</td>
      <td>0.1</td>
      <td>9.9</td>
    </tr>
    <tr>
      <th>359</th>
      <td>めキャベツ 結球葉 ゆで</td>
      <td>51</td>
      <td>5.3</td>
      <td>0.1</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>221</th>
      <td>（トマト類） 赤色トマト 果実 生</td>
      <td>20</td>
      <td>0.7</td>
      <td>0.1</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>222</th>
      <td>（トマト類） 赤色ミニトマト 果実 生</td>
      <td>30</td>
      <td>1.1</td>
      <td>0.1</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>223</th>
      <td>（トマト類） 黄色トマト 果実 生</td>
      <td>18</td>
      <td>1.1</td>
      <td>0.4</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>224</th>
      <td>（トマト類） ドライトマト</td>
      <td>291</td>
      <td>14.2</td>
      <td>2.1</td>
      <td>67.3</td>
    </tr>
    <tr>
      <th>225</th>
      <td>（トマト類） 加工品 ホール 食塩無添加</td>
      <td>21</td>
      <td>0.9</td>
      <td>0.2</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>226</th>
      <td>（トマト類） 加工品 トマトジュース 食塩添加</td>
      <td>15</td>
      <td>0.7</td>
      <td>0.1</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>227</th>
      <td>（トマト類） 加工品 トマトジュース 食塩無添加</td>
      <td>18</td>
      <td>0.7</td>
      <td>0.1</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>228</th>
      <td>（トマト類） 加工品 ミックスジュース 食塩添加</td>
      <td>18</td>
      <td>0.6</td>
      <td>0</td>
      <td>4.3</td>
    </tr>
    <tr>
      <th>229</th>
      <td>（トマト類） 加工品 ミックスジュース 食塩無添加</td>
      <td>18</td>
      <td>0.6</td>
      <td>0</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="dataframecsv-excel">
<h2>DataFrameのcsv/Excelファイルへの書き出し<a class="headerlink" href="#dataframecsv-excel" title="Link to this heading">#</a></h2>
<p>DataFrameオブジェクトは、<code class="docutils literal notranslate"><span class="pre">pandas</span></code>内の関数・メソッドを用いれば、簡単にcsvやExcelファイルとして書き出すことができる。</p>
<p>実行履歴に残っている適当なDataFrameを、Google Driveにファイルとして書き出してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">google.colab</span><span class="w"> </span><span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>csvとして書き出す場合</strong></p>
<p>適当にパスを指定して、DataFrameオブジェクトに<code class="docutils literal notranslate"><span class="pre">to_csv</span></code>関数を作用させる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/pd_write_test.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Excelファイルとして書き出す場合</strong></p>
<p>この場合も同様で、<code class="docutils literal notranslate"><span class="pre">to_excel</span></code>関数を用いればよい。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/pd_write_test.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>上記の関数内で書き出しに使う文字コードを指定することもできる。<br />
例: <code class="docutils literal notranslate"><span class="pre">encoding=&quot;utf-8_sig&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">encoding=&quot;shift_jis&quot;</span></code></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="LaTeX_in_markdown.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">LaTeXの記法</p>
      </div>
    </a>
    <a class="right-next"
       href="Python_misc_numpy.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Numpyについて</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">DataFrame型</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">DataFrameの要素を確認・指定する方法</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">特定の列を取得したい場合</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">列の追加</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">特定の行を取得したい場合</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">より複雑な行・列の抽出</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#webdataframe">Webページにある表をDataFrameとして取得する</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandascsv-excel">Pandasでcsv/Excelファイルを読み込む</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#csv">csvファイルの読み込み</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excel">Excelファイルの読み込み</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Excelファイルの読み込みに関する補足</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">データの整形</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframecsv-excel">DataFrameのcsv/Excelファイルへの書き出し</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  © Copyright 2020- by 吉田 聡太 (Sota Yoshida). 本コンテンツは<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 ライセンス</a>の下に提供されています。 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>　ただし、資料中のコードセル部分は<a rel="license" href="https://opensource.org/licenses/MIT">MITライセンス</a>の下に提供されています。

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>